# render.yaml â€” Blueprint for NoellaButi/code-banking-app

services:
  - type: web
    name: banklite-web
    runtime: python          # (newer field; replaces deprecated 'env')
    plan: free
    branch: main
    autoDeployTrigger: commit
    region: oregon           # keep app & DB in same region

    buildCommand: pip install --upgrade pip && pip install -r requirements.txt
    startCommand: gunicorn app.wsgi:app
    preDeployCommand: flask db upgrade   # run migrations before starting

    envVars:
      - key: FLASK_APP
        value: app.wsgi:app
      - key: SECRET_KEY
        generateValue: true
      # Wire DB URL from the database defined below
      - key: SQLALCHEMY_DATABASE_URI
        fromDatabase:
          name: banklite-db
          property: connectionString

databases:
  - name: banklite-db
    plan: free
    region: oregon
    # optional extras:
    # postgresMajorVersion: '17'
    # ipAllowList: []  # only allow private/internal connections
